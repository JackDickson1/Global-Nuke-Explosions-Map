<!DOCTYPE html>
<html>
<head>
  <title>Global Nuclear Explosions</title>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
  <style>
    html, body { height: 100%; margin: 0; padding: 0; }
    #map { width: 100%; height: 100%; }

#mapTitle {
  position: absolute;
  top: 15px;
  left: 55px;
  background: rgba(255, 255, 255, 0.9);
  border-radius: 12px;
  padding: 10px 20px;
  font-family: "Arial Black", sans-serif;
  font-size: 22px;
  color: #D16200; 
  text-shadow:
    -1px -1px 0 #8B0000,
     1px -1px 0 #8B0000,
    -1px  1px 0 #8B0000,
     1px  1px 0 #8B0000; 
  box-shadow: 0 0 8px rgba(0,0,0,0.3);
  z-index: 1000; 
}


    .info.legend {
  background: white;
  padding: 10px 14px;
  font: 14px/16px Arial, Helvetica, sans-serif;
  box-shadow: 0 0 10px rgba(0,0,0,0.2);
  border-radius: 8px;
  color: #333;
}

.info.legend h4 {
  margin: 0 0 8px;
  text-align: left;
  font-weight: bold;
  font-size: 14px;
}

.legend-item {
  display: flex;
  align-items: center;
  margin: 4px 0;
  gap: 8px;
}

.legend-item svg {
  flex-shrink: 0;
  display: block;
}
  </style>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
          integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-ajax/2.1.0/leaflet.ajax.min.js"></script>

</head>

<body>
  <div id="map"></div>
<div id="mapTitle">Global Nuclear Test Sites</div>

  <script>
   
    var map = L.map('map', {
      center: [39.4, -8.2],
      zoom: 3
    });

var Esri_WorldTopoMap = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}', {
	attribution: 'Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ, TomTom, Intermap, iPC, USGS, FAO, NPS, NRCAN, GeoBase, Kadaster NL, Ordnance Survey, Esri Japan, METI, Esri China (Hong Kong), and the GIS User Community'
}).addTo(map);

    sites = L.geoJson.ajax("assets/data.geojson", {
  attribution: 'Data: ArcGIS Online feature layer created by Damian Spangrud. Map: Jack Dickson',
  
  pointToLayer: function (feature, latlng) {

    var marker = L.circleMarker(latlng, {
      color: '#8B0000',
      opacity: 1,
      weight: 2,
      fillColor: '#D16200',
      fillOpacity: 0.5,
      radius: calcRadius(feature.properties.Yield_tonnes)
    });

    var popupContent = `
      <b>${feature.properties.Name || 'Unknown Site'}</b><br>
      <b>Yield:</b> ${feature.properties.Yield_tonnes?.toLocaleString() || 'N/A'} tonnes<br>
      <b>Purpose:</b> ${feature.properties.Purpose || 'N/A'}
    `;

    marker.bindPopup(popupContent);

    return marker;
  }
});

      
      
      
      var minValue = 1;
            var minRadius = 5;
            function calcRadius(val) {
            return 1.00 * Math.pow(val/minValue,.1) * minRadius;
            }
            sites.addTo(map);
            L.control.scale({position: 'bottomleft'}).addTo(map);


            // adding a legend

var legend = L.control({ position: 'bottomright' });

legend.onAdd = function (map) {
  var div = L.DomUtil.create('div', 'info legend');
  var grades = [10000, 100000, 1000000, 58000000]; 

  div.innerHTML += '<h4>Estimated Yield (tonnes)</h4>';

  for (var i = 0; i < grades.length; i++) {
    var radius = calcRadius(grades[i]);
    var diameter = radius * 2;


    div.innerHTML +=
      '<div class="legend-item">' +
        '<svg width="' + diameter + '" height="' + diameter + '">' +
          '<circle cx="' + radius + '" cy="' + radius + '" r="' + radius + '" ' +
          'stroke="#8B0000" stroke-width="2" fill="#ff7900" fill-opacity="0.6" />' +
        '</svg>' +
        '<span>' + grades[i].toLocaleString() + '</span>' +
      '</div>';
  }

  return div;
};

legend.addTo(map);







  </script>
</body>
</html>
